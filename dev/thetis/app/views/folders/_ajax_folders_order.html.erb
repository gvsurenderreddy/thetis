
<% if Folder.check_user_auth(@folder_id, @login_user, 'w', true) %>

  <% if @folders.nil? or @folders.empty? %>

    <table width="100%" height="100%" bgcolor="cornsilk" cellpadding="0" cellspacing="0">
      <tr>
        <td valign="top">
          <br/><br/><br/>
          <table align="center" width="80%" cellpadding="0" cellspacing="0">
            <tr>
              <td align="center" style="padding:10px; color:firebrick; background-color:white; border:5px moccasin dashed;">
                <%= t('paren.no_folders') %>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>

  <% else %>

    <table width="100%" height="100%" bgcolor="cornsilk" cellpadding="0" cellspacing="0">
      <tr>
        <td id="sortable_items" valign="top">
        <%
        @folders.each_with_index do |folder, idx|
          td_class = (idx % 2 == 1) ? 'list_td_off' : 'list_td_on'
        %>
          <div class="<%= td_class %>" id="folder_<%= folder.id %>" style="padding:0px;">
            <table align="center" width="100%" cellpadding="0" cellspacing="0">
              <tr>
                <td style="cursor:move; border:2px solid white;" onMouseOver="this.style.borderColor='lime'" onMouseOut="this.style.borderColor='white'">
                  <img src="<%= THETIS_RELATIVE_URL_ROOT %>/images/up_down.gif" alt="<%= t('msg.drag_to_change_orger') %>" style="cursor:move" />
                  [<%= folder.id %>]&nbsp;&nbsp;<span style="color:navy;"><%=h truncate(folder.name, :length => 20) %></span>
                </td>
              </tr>
            </table>
          </div>
        <% end %>
        </td>
      </tr>
    </table>

    <%= sortable_element('sortable_items', :url => {:controller => 'folders', :action => 'update_folders_order', :id => Folder.find(@folders.first).parent_id }, :with => "Sortable.serialize('sortable_items', {name:'folders_order'})", :tag => 'div') %>

  <% end %>

<% else %>

  <table width="100%" height="100%" valign="top" bgcolor="cornsilk" cellpadding="0" cellspacing="0">
    <tr>
      <td valign="top">
        <br/><br/><br/>
        <table align="center" width="80%" cellpadding="0" cellspacing="0">
          <tr>
            <td valign="top" style="padding:10px; color:firebrick; background-color:white; border:5px moccasin dashed;">
              <%= t('folder.need_auth_to_modify') %>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>

<% end %>
