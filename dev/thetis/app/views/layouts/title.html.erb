<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Script-Type" content="text/JavaScript">

<title>Thetis: <%= controller.action_name %></title>

<%= stylesheet_link_tag('application', :media => 'all') %>
<%= javascript_include_tag('application') %>
<!--
<link href="<%= THETIS_RELATIVE_URL_ROOT %>/stylesheets/thetis110.css" media="all" rel="stylesheet" type="text/css" />
<link href="<%= THETIS_RELATIVE_URL_ROOT %>/stylesheets/thetisbox.css" media="all" rel="stylesheet" type="text/css" />
<script src="<%= THETIS_RELATIVE_URL_ROOT %>/javascripts/prototype.js" type="text/javascript"></script>
<script src="<%= THETIS_RELATIVE_URL_ROOT %>/javascripts/thetis/common110.js?ts=2012042601" type="text/javascript"></script>
<script src="<%= THETIS_RELATIVE_URL_ROOT %>/javascripts/thetis/thetisbox110.js" type="text/javascript"></script>
<script src="<%= THETIS_RELATIVE_URL_ROOT %>/javascripts/thetis/thetis110.js?ts=2012052901" type="text/javascript"></script>
-->

<script type="text/javascript">
<%
login_name = (@login_user.nil?)?'':@login_user.name
login_admin = (!@login_user.nil? and @login_user.admin?)?'true':'false'
%>
setHeaderLogin("<%= login_name %>");
setLeftLogin("<%= login_name %>", <%= login_admin %>);

function doOnLoad()
{
  setTimeout("doResize()", 10);

<% if params[:topicBox] == 'true' %>
  setTimeout("showTopicBox()", 10);
<% end %>
}

function doResize()
{
  var mainRegion = getClientRegion();
  var mainWidth = mainRegion.width;
  var mainHeight = mainRegion.height;

  var main_div = _z("main_div");
  main_div.style.height = mainHeight + "px";
  main_div.style.width = "100%";
}

function showTopicBox()
{
  var mainRegion = getClientRegion();
  var mainWidth = mainRegion.width;
  var mainHeight = mainRegion.height;

  var thetisBox = new ThetisBox;
  thetisBox.title = "<%= t('topicbox.title') %>";
  thetisBox.show("CENTER", (mainWidth/10*7)+","+(mainHeight/10*7), "IFRAME", "", "<%= $thetis_config[:topic]['caption'] %>", "<%= THETIS_TOPICS_URL %>?"+((new Date()).getTime()));
  _z('divThetisBox-' + thetisBox.id).style.zIndex += 1;
}

addEvent(window, "resize", doResize);

</script>
</head>

<body onLoad="doOnLoad();">

<div id="main_div" style="vertical-align:top; background:url(<%= THETIS_RELATIVE_URL_ROOT %>/images/stripeback.png) repeat-y white; overflow:auto;">
  <%= yield %>
</div>

<%= render(:partial => 'layouts/popup') %>

</body>
</html>
