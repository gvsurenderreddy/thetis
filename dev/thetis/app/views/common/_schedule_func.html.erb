<%
from ||= nil
%>

<script type="text/javascript">

var thetisBoxScheduleDetail = null;

showScheduleDetail = function(date, schedule_id, title, addParams)
{
  if (thetisBoxScheduleDetail != null) {
    thetisBoxScheduleDetail.remove();
    thetisBoxScheduleDetail = null;
  }

  var thetisBox = new ThetisBox;
  thetisBox.title = "<%= Schedule.model_name.human %> <%= t('msg.hyphen') %> "+title;
  thetisBox.bgcolor_title = "limegreen";
  thetisBox.bgcolor_body = "lightcyan";

  if (!addParams) {
    addParams = new Array();
  }
  addParams.push("id="+schedule_id);
  addParams.push("date="+date);
<% unless from.nil? %>
  addParams.push("from=<%= from %>");
<% end %>

  var thetisBoxProgress = prog("CENTER");
  new Ajax.Request(
          "<%= url_for(:controller => 'schedules', :action => 'show') %>",
          {
            method:"get",
            asynchronous:true,
            parameters:addParams.join("&"),
            evalScripts:true,
            onComplete:function(request) {
                thetisBoxProgress.remove();

                thetisBox.show(
                          "CENTER",
                          mainWidth*80/100+"," + mainHeight*80/100,
                          "TRAY",
                          "",
                          "",
                          request.responseText.stripScripts()
                        );
                request.responseText.evalScripts();
              }
          }
        );
}

editScheduleDetail = function(date, id)
{
  prog("TOP-RIGHT");
  location.href="<%= url_for(:controller => 'schedules', :action => 'day') %>?date="+date+"&edit_id="+id;
}

doScheduleDelete = function(date, id, title)
{
  confm("<%= t('paren.square.left') %>"+title+"<%= t('schedule.confirm_to_delete') %>", "_doScheduleDelete('"+date+"', '"+id+"')");
}

_doScheduleDelete = function(date, id)
{
  prog("TOP-RIGHT");
  location.href="<%= url_for(:controller => 'schedules', :action => 'day') %>?date="+date+"&doDelete="+id;
}

</script>
